<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>IdsaAppender.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.3 on Fri Dec 22 10:52:45 2000 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; </center>
<hr><h1>IdsaAppender.cpp</h1><a href="IdsaAppender_cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">/*</font>
00002 <font class="comment"> * IdsaAppender.cpp</font>
00003 <font class="comment"> *</font>
00004 <font class="comment"> * Copyright 2000, Marc Welz</font>
00005 <font class="comment"> *</font>
00006 <font class="comment"> * See the COPYING file for the terms of usage and distribution.</font>
00007 <font class="comment"> */</font>
00008 
00009 <font class="preprocessor">#include "config.h"</font>
00010 <font class="preprocessor">#if HAVE_LIBIDSA</font>
00011 <font class="preprocessor"></font>
00012 <font class="preprocessor">#include &lt;unistd.h&gt;</font>
00013 <font class="preprocessor">#include &lt;sys/types.h&gt;</font>
00014 <font class="preprocessor">#include &lt;sys/stat.h&gt;</font>
00015 <font class="preprocessor">#include &lt;fcntl.h&gt;</font>
00016 <font class="preprocessor">#include "<a class="code" href="IdsaAppender_hh.html">log4cpp/IdsaAppender.hh</a>"</font>
00017 
00018 <font class="keyword">namespace</font> log4cpp {
00019 
00020     IdsaAppender::IdsaAppender(<font class="keyword">const</font> string&amp; name, 
00021                                <font class="keyword">const</font> string&amp; idsaName) :
00022         Appender(name),
00023         _idsaName(idsaName)
00024     {
00025         _idsaConnection=NULL;
00026         open();
00027     }
00028     
00029     IdsaAppender::~IdsaAppender()<font class="keyword"> </font>{
00030         close();
00031     }
00032 
00033     <font class="keywordtype">void</font> IdsaAppender::open()<font class="keyword"> </font>{
00034         _idsaConnection=idsa_open((<font class="keywordtype">char</font> *)_idsaName.c_str(), NULL,
00035                                   IDSA_F_FAILOPEN);
00036     }
00037 
00038     <font class="keywordtype">void</font> IdsaAppender::close()<font class="keyword"> </font>{
00039         idsa_close(_idsaConnection);
00040         _idsaConnection=NULL;
00041     }
00042 
00043     <font class="keywordtype">void</font> IdsaAppender::doAppend(<font class="keyword">const</font> LoggingEvent&amp; event)<font class="keyword"> </font>{
00044         IDSA_EVENT *idsaEvent;
00045         
00046         idsaEvent = idsa_event(_idsaConnection);
00047         
00048         <font class="keywordflow">if</font> (idsaEvent){
00049             
00050             idsa_name(idsaEvent,(<font class="keywordtype">char</font> *)event.categoryName.c_str());
00051             idsa_scheme(idsaEvent,<font class="stringliteral">"log4cpp"</font>);
00052             
00053             idsa_add_integer(idsaEvent, <font class="stringliteral">"priority"</font>, event.priority);
00054             idsa_add_string(idsaEvent, <font class="stringliteral">"ndc"</font>, (<font class="keywordtype">char</font> *)event.ndc.c_str());
00055             idsa_add_string(idsaEvent, <font class="stringliteral">"message"</font>, 
00056                             (<font class="keywordtype">char</font>*)event.message.c_str());
00057             
00058             idsa_log(_idsaConnection,idsaEvent);
00059             <font class="comment">// idsa_log does its own deallocation */</font>
00060         }
00061     }
00062 
00063     <font class="keywordtype">bool</font> IdsaAppender::reopen()<font class="keyword"> </font>{
00064         close();
00065         open();
00066         <font class="keywordflow">return</font> <font class="keyword">true</font>;
00067     }      
00068 
00069     <font class="keywordtype">bool</font> IdsaAppender::requiresLayout()<font class="keyword"> const </font>{
00070         <font class="keywordflow">return</font> <font class="keyword">false</font>;
00071     }
00072 
00073     <font class="keywordtype">void</font> IdsaAppender::setLayout(Layout* layout)<font class="keyword"> </font>{
00074         <font class="keywordflow">return</font>;
00075     }
00076 
00077 }
00078 
00079 <font class="preprocessor">#endif // HAVE_LIBIDSA</font>
</font></div></pre><hr><address><small>Generated at Fri Dec 22 10:52:45 2000 for log4cpp by
<a href="http://www.stack.nl/~dimitri/doxygen/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.3 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2000</small></address>
</body>
</html>
